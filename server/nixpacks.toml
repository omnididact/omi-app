[phases.setup]
nixPkgs = ["nodejs_20", "python3"]

[phases.install]
cmds = [
  "echo 'ğŸ“¦ Installing dependencies for Railway deployment...'",
  "npm ci --omit=dev --no-audit --prefer-offline --verbose",
  "echo 'ğŸ“‹ Listing installed packages:'",
  "npm list --depth=0"
]

[phases.build]
cmds = [
  "echo 'ğŸ”¨ Build phase starting...'",
  "echo 'ğŸ“ Node version:' && node --version",
  "echo 'ğŸ“ NPM version:' && npm --version",
  "echo 'ğŸ“ Environment: $NODE_ENV'",
  "echo 'ğŸ“ Current directory:' && pwd",
  "echo 'ğŸ“ Directory contents:' && ls -la",
  "echo 'ğŸ“ Package.json exists:' && test -f package.json && echo 'YES' || echo 'NO'",
  "echo 'ğŸ“ Index.js exists:' && test -f index.js && echo 'YES' || echo 'NO'",
  "echo 'âœ… Build completed successfully'"
]

[start]
cmd = "node index.js"

[variables]
NODE_ENV = "production" 